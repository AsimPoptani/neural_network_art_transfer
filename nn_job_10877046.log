Pulling latest
Already up-to-date.
Loading Modules

The following have been reloaded with a version change:
  1) compiler/GCCcore/9.3.0 => compiler/GCCcore/8.3.0
  2) lib/zlib/1.2.11-GCCcore-9.3.0 => lib/zlib/1.2.11-GCCcore-8.3.0
  3) tools/binutils/2.34-GCCcore-9.3.0 => tools/binutils/2.32-GCCcore-8.3.0

Found previous venv deleting
Setting up venv
/users/ap1751/scratch/neural_network_art_transfer
upgarding pip
Collecting pip
  Using cached https://files.pythonhosted.org/packages/ab/11/2dc62c5263d9eb322f2f028f7b56cd9d096bb8988fcf82d65fa2e4057afe/pip-20.3.1-py2.py3-none-any.whl
Installing collected packages: pip
  Found existing installation: pip 19.2.3
    Uninstalling pip-19.2.3:
      Successfully uninstalled pip-19.2.3
Successfully installed pip-20.3.1
Installing requiremnts
Collecting absl-py==0.11.0
  Using cached absl_py-0.11.0-py3-none-any.whl (127 kB)
Collecting astunparse==1.6.3
  Using cached astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Collecting backcall==0.2.0
  Using cached backcall-0.2.0-py2.py3-none-any.whl (11 kB)
Collecting cachetools==4.1.1
  Using cached cachetools-4.1.1-py3-none-any.whl (10 kB)
Collecting certifi==2020.11.8
  Using cached certifi-2020.11.8-py2.py3-none-any.whl (155 kB)
Collecting chardet==3.0.4
  Using cached chardet-3.0.4-py2.py3-none-any.whl (133 kB)
Collecting decorator==4.4.2
  Using cached decorator-4.4.2-py2.py3-none-any.whl (9.2 kB)
Collecting gast==0.3.3
  Using cached gast-0.3.3-py2.py3-none-any.whl (9.7 kB)
Collecting google-auth==1.23.0
  Using cached google_auth-1.23.0-py2.py3-none-any.whl (114 kB)
Requirement already satisfied: setuptools>=40.3.0 in ./venv/lib/python3.8/site-packages (from google-auth==1.23.0->-r requirements.txt (line 11)) (41.2.0)
Collecting google-auth-oauthlib==0.4.2
  Using cached google_auth_oauthlib-0.4.2-py2.py3-none-any.whl (18 kB)
Collecting google-pasta==0.2.0
  Using cached google_pasta-0.2.0-py3-none-any.whl (57 kB)
Collecting grpcio==1.33.2
  Using cached grpcio-1.33.2-cp38-cp38-manylinux2014_x86_64.whl (3.8 MB)
Collecting h5py==2.10.0
  Using cached h5py-2.10.0-cp38-cp38-manylinux1_x86_64.whl (2.9 MB)
Collecting idna==2.10
  Using cached idna-2.10-py2.py3-none-any.whl (58 kB)
Collecting ipython==7.19.0
  Using cached ipython-7.19.0-py3-none-any.whl (784 kB)
Requirement already satisfied: setuptools>=40.3.0 in ./venv/lib/python3.8/site-packages (from google-auth==1.23.0->-r requirements.txt (line 11)) (41.2.0)
Collecting ipython-genutils==0.2.0
  Using cached ipython_genutils-0.2.0-py2.py3-none-any.whl (26 kB)
Collecting jedi==0.17.2
  Using cached jedi-0.17.2-py2.py3-none-any.whl (1.4 MB)
Collecting Keras-Preprocessing==1.1.2
  Using cached Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)
Collecting Markdown==3.3.3
  Using cached Markdown-3.3.3-py3-none-any.whl (96 kB)
Collecting matplotlib
  Using cached matplotlib-3.3.3-cp38-cp38-manylinux1_x86_64.whl (11.6 MB)
Collecting numpy
  Using cached numpy-1.19.4-cp38-cp38-manylinux2010_x86_64.whl (14.5 MB)
Collecting oauthlib==3.1.0
  Using cached oauthlib-3.1.0-py2.py3-none-any.whl (147 kB)
Collecting opt-einsum==3.3.0
  Using cached opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Collecting pandas==1.1.4
  Using cached pandas-1.1.4-cp38-cp38-manylinux1_x86_64.whl (9.3 MB)
Collecting parso==0.7.1
  Using cached parso-0.7.1-py2.py3-none-any.whl (109 kB)
Collecting pexpect==4.8.0
  Using cached pexpect-4.8.0-py2.py3-none-any.whl (59 kB)
Collecting pickleshare==0.7.5
  Using cached pickleshare-0.7.5-py2.py3-none-any.whl (6.9 kB)
Collecting pillow
  Using cached Pillow-8.0.1-cp38-cp38-manylinux1_x86_64.whl (2.2 MB)
Collecting prompt-toolkit==3.0.8
  Using cached prompt_toolkit-3.0.8-py3-none-any.whl (355 kB)
Collecting protobuf==3.14.0
  Using cached protobuf-3.14.0-cp38-cp38-manylinux1_x86_64.whl (1.0 MB)
Collecting ptyprocess==0.6.0
  Using cached ptyprocess-0.6.0-py2.py3-none-any.whl (39 kB)
Collecting pyasn1==0.4.8
  Using cached pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)
Collecting pyasn1-modules==0.2.8
  Using cached pyasn1_modules-0.2.8-py2.py3-none-any.whl (155 kB)
Collecting Pygments==2.7.2
  Using cached Pygments-2.7.2-py3-none-any.whl (948 kB)
Collecting python-dateutil==2.8.1
  Using cached python_dateutil-2.8.1-py2.py3-none-any.whl (227 kB)
Collecting pytz==2020.4
  Using cached pytz-2020.4-py2.py3-none-any.whl (509 kB)
Collecting requests==2.25.0
  Using cached requests-2.25.0-py2.py3-none-any.whl (61 kB)
Collecting requests-oauthlib==1.3.0
  Using cached requests_oauthlib-1.3.0-py2.py3-none-any.whl (23 kB)
Collecting rsa==4.6
  Using cached rsa-4.6-py3-none-any.whl (47 kB)
Collecting six==1.15.0
  Using cached six-1.15.0-py2.py3-none-any.whl (10 kB)
Collecting tensorboard==2.4.0
  Using cached tensorboard-2.4.0-py3-none-any.whl (10.6 MB)
Requirement already satisfied: setuptools>=40.3.0 in ./venv/lib/python3.8/site-packages (from google-auth==1.23.0->-r requirements.txt (line 11)) (41.2.0)
Collecting tensorboard-plugin-wit==1.7.0
  Using cached tensorboard_plugin_wit-1.7.0-py3-none-any.whl (779 kB)
Collecting tensorflow==2.3.1
  Using cached tensorflow-2.3.1-cp38-cp38-manylinux2010_x86_64.whl (320.5 MB)
Collecting numpy
  Using cached numpy-1.18.5-cp38-cp38-manylinux1_x86_64.whl (20.6 MB)
Collecting tensorflow-estimator==2.3.0
  Using cached tensorflow_estimator-2.3.0-py2.py3-none-any.whl (459 kB)
Collecting termcolor==1.1.0
  Using cached termcolor-1.1.0.tar.gz (3.9 kB)
Collecting traitlets==5.0.5
  Using cached traitlets-5.0.5-py3-none-any.whl (100 kB)
Collecting urllib3==1.26.2
  Using cached urllib3-1.26.2-py2.py3-none-any.whl (136 kB)
Collecting wcwidth==0.2.5
  Using cached wcwidth-0.2.5-py2.py3-none-any.whl (30 kB)
Collecting Werkzeug==1.0.1
  Using cached Werkzeug-1.0.1-py2.py3-none-any.whl (298 kB)
Collecting wrapt==1.12.1
  Using cached wrapt-1.12.1.tar.gz (27 kB)
Collecting cycler>=0.10
  Using cached cycler-0.10.0-py2.py3-none-any.whl (6.5 kB)
Collecting kiwisolver>=1.0.1
  Using cached kiwisolver-1.3.1-cp38-cp38-manylinux1_x86_64.whl (1.2 MB)
Collecting pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3
  Using cached pyparsing-2.4.7-py2.py3-none-any.whl (67 kB)
Collecting wheel<1.0,>=0.23.0
  Using cached wheel-0.36.0-py2.py3-none-any.whl (34 kB)
Using legacy 'setup.py install' for termcolor, since package 'wheel' is not installed.
Using legacy 'setup.py install' for wrapt, since package 'wheel' is not installed.
Installing collected packages: urllib3, pyasn1, idna, chardet, certifi, six, rsa, requests, pyasn1-modules, oauthlib, cachetools, requests-oauthlib, google-auth, wheel, Werkzeug, wcwidth, tensorboard-plugin-wit, ptyprocess, protobuf, parso, numpy, Markdown, ipython-genutils, grpcio, google-auth-oauthlib, absl-py, wrapt, traitlets, termcolor, tensorflow-estimator, tensorboard, pytz, python-dateutil, pyparsing, Pygments, prompt-toolkit, pillow, pickleshare, pexpect, opt-einsum, kiwisolver, Keras-Preprocessing, jedi, h5py, google-pasta, gast, decorator, cycler, backcall, astunparse, tensorflow, pandas, matplotlib, ipython
    Running setup.py install for wrapt: started
    Running setup.py install for wrapt: finished with status 'done'
    Running setup.py install for termcolor: started
    Running setup.py install for termcolor: finished with status 'done'
Successfully installed Keras-Preprocessing-1.1.2 Markdown-3.3.3 Pygments-2.7.2 Werkzeug-1.0.1 absl-py-0.11.0 astunparse-1.6.3 backcall-0.2.0 cachetools-4.1.1 certifi-2020.11.8 chardet-3.0.4 cycler-0.10.0 decorator-4.4.2 gast-0.3.3 google-auth-1.23.0 google-auth-oauthlib-0.4.2 google-pasta-0.2.0 grpcio-1.33.2 h5py-2.10.0 idna-2.10 ipython-7.19.0 ipython-genutils-0.2.0 jedi-0.17.2 kiwisolver-1.3.1 matplotlib-3.3.3 numpy-1.18.5 oauthlib-3.1.0 opt-einsum-3.3.0 pandas-1.1.4 parso-0.7.1 pexpect-4.8.0 pickleshare-0.7.5 pillow-8.0.1 prompt-toolkit-3.0.8 protobuf-3.14.0 ptyprocess-0.6.0 pyasn1-0.4.8 pyasn1-modules-0.2.8 pyparsing-2.4.7 python-dateutil-2.8.1 pytz-2020.4 requests-2.25.0 requests-oauthlib-1.3.0 rsa-4.6 six-1.15.0 tensorboard-2.4.0 tensorboard-plugin-wit-1.7.0 tensorflow-2.3.1 tensorflow-estimator-2.3.0 termcolor-1.1.0 traitlets-5.0.5 urllib3-1.26.2 wcwidth-0.2.5 wheel-0.36.0 wrapt-1.12.1
2020-12-03 18:59:49.756919: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:49.757402: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.139010: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-12-03 18:59:52.235871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:1c:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.237654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:1d:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.237822: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.240788: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-12-03 18:59:52.243367: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-12-03 18:59:52.244158: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-12-03 18:59:52.246868: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-12-03 18:59:52.248347: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-12-03 18:59:52.253116: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-12-03 18:59:52.258966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2020-12-03 18:59:52.259601: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-12-03 18:59:52.268480: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2000000000 Hz
2020-12-03 18:59:52.268676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x44a5e80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-03 18:59:52.268688: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-03 18:59:52.274713: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-12-03 18:59:52.293383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:1c:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.296690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:1d:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.296717: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.298863: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-12-03 18:59:52.301305: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-12-03 18:59:52.301835: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-12-03 18:59:52.304186: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-12-03 18:59:52.305521: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-12-03 18:59:52.309784: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-12-03 18:59:52.381169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2020-12-03 18:59:52.382552: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-12-03 18:59:52.414619: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2000000000 Hz
2020-12-03 18:59:52.414974: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4f9fe80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-03 18:59:52.415013: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-03 18:59:52.760412: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4523170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-12-03 18:59:52.760437: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-32GB, Compute Capability 7.0
2020-12-03 18:59:52.760442: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla V100-SXM2-32GB, Compute Capability 7.0
2020-12-03 18:59:52.762096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:1c:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.763500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:1d:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.763524: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.763544: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-12-03 18:59:52.763553: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-12-03 18:59:52.763562: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-12-03 18:59:52.763570: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-12-03 18:59:52.763578: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-12-03 18:59:52.763587: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-12-03 18:59:52.768918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2020-12-03 18:59:52.768946: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.798603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x501d170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-12-03 18:59:52.798632: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-32GB, Compute Capability 7.0
2020-12-03 18:59:52.798639: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla V100-SXM2-32GB, Compute Capability 7.0
2020-12-03 18:59:52.800672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:1c:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.802400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:1d:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.72GiB deviceMemoryBandwidth: 836.37GiB/s
2020-12-03 18:59:52.802430: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:52.802452: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-12-03 18:59:52.802463: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-12-03 18:59:52.802476: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-12-03 18:59:52.802487: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-12-03 18:59:52.802498: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2020-12-03 18:59:52.802510: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2020-12-03 18:59:52.813325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2020-12-03 18:59:52.813385: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2020-12-03 18:59:54.197139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-03 18:59:54.197328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-03 18:59:54.197434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 1 
2020-12-03 18:59:54.197448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N Y 
2020-12-03 18:59:54.197452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 1:   Y N 
2020-12-03 18:59:54.197503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 1 
2020-12-03 18:59:54.197543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N Y 
2020-12-03 18:59:54.197579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 1:   Y N 
2020-12-03 18:59:54.205777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 29676 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:1c:00.0, compute capability: 7.0)
2020-12-03 18:59:54.207452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 29676 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:1c:00.0, compute capability: 7.0)
2020-12-03 18:59:54.209201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 29676 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-32GB, pci bus id: 0000:1d:00.0, compute capability: 7.0)
2020-12-03 18:59:54.211290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 29676 MB memory) -> physical GPU (device: 1, name: Tesla V100-SXM2-32GB, pci bus id: 0000:1d:00.0, compute capability: 7.0)
2020-12-03 18:59:54.244648: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 28.98G (31118440448 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.247166: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 26.08G (28006596608 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.249607: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 23.47G (25205936128 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.252049: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 21.13G (22685341696 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.254473: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 19.01G (20416806912 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.256890: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 17.11G (18375124992 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.259374: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 15.40G (16537612288 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.261709: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 13.86G (14883850240 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.264004: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 12.47G (13395465216 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.266340: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 11.23G (12055918592 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.268730: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 10.10G (10850326528 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.270993: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 9.09G (9765294080 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.273183: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 8.18G (8788764672 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.275417: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 7.37G (7909888000 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.277620: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 6.63G (7118899200 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.279815: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 5.97G (6407009280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.281988: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 5.37G (5766308352 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.284098: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 4.83G (5189677568 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.286310: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 4.35G (4670709760 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.288437: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.91G (4203638784 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.290535: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.52G (3783274752 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.292627: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.17G (3404947200 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.294655: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.85G (3064452352 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.296715: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.57G (2758007040 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.298822: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.31G (2482206208 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.300863: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.08G (2233985536 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.302959: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.87G (2010586880 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-12-03 18:59:54.339859: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2020-12-03 18:59:55.163491: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
slurmstepd: error: Detected 2 oom-kill event(s) in step 10877046.0 cgroup. Some of your processes may have been killed by the cgroup out-of-memory handler.
2020-12-03 18:59:58.424274: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
srun: error: gpu01: task 1: Out Of Memory
Model: "vgg19"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 300, 300, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 300, 300, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 300, 300, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 150, 150, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 150, 150, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 150, 150, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 75, 75, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 75, 75, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 75, 75, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 75, 75, 256)       590080    
_________________________________________________________________
block3_conv4 (Conv2D)        (None, 75, 75, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 37, 37, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 37, 37, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 37, 37, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 37, 37, 512)       2359808   
_________________________________________________________________
block4_conv4 (Conv2D)        (None, 37, 37, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 18, 18, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 18, 18, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 18, 18, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 18, 18, 512)       2359808   
_________________________________________________________________
block5_conv4 (Conv2D)        (None, 18, 18, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 9, 9, 512)         0         
_________________________________________________________________
global_average_pooling2d (Gl (None, 512)               0         
=================================================================
Total params: 20,024,384
Trainable params: 20,024,384
Non-trainable params: 0
_________________________________________________________________
tf.Tensor(45106724.0, shape=(), dtype=float32)
Traceback (most recent call last):
  File "index.py", line 167, in <module>
    image_to_save.save(f"generated_images/{epoch}_image.jpg")
  File "/mnt/lustre/users/ap1751/neural_network_art_transfer/venv/lib/python3.8/site-packages/PIL/Image.py", line 2148, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'generated_images/0_image.jpg'
slurmstepd: error: Detected 2 oom-kill event(s) in step 10877046.batch cgroup. Some of your processes may have been killed by the cgroup out-of-memory handler.

============================
 Job utilisation efficiency
============================

Job ID: 10877046
Cluster: viking
User/Group: ap1751/clusterusers
State: OUT_OF_MEMORY (exit code 0)
Nodes: 1
Cores per node: 2
CPU Utilized: 00:01:28
CPU Efficiency: 34.65% of 00:04:14 core-walltime
Job Wall-clock time: 00:02:07
Memory Utilized: 3.53 GB (estimated maximum)
Memory Efficiency: 88.33% of 4.00 GB (4.00 GB/node)
 Requested wall clock time: 00:30:00
    Actual wall clock time: 00:02:07
Wall clock time efficiency: 7.1%
           Job queued time: 00:00:01
